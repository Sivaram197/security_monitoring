import logging
import socket

# Configure logging
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')

def check_port(host, port):
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
        sock.settimeout(1)  # Set timeout for socket operations
        result = sock.connect_ex((host, port))
        return result == 0

def run():
    logging.info('Basic Vulnerability Checker started')
    
    vulnerable_ports = [21, 22, 80, 443]
    localhost = '127.0.0.1'
    open_ports = []

    for port in vulnerable_ports:
        try:
            if check_port(localhost, port):
                logging.warning(f'Vulnerable port open: {port}')
                open_ports.append(port)
        except Exception as e:
            logging.error(f'Error checking port {port}: {e}')
    
    if open_ports:
        logging.info(f'Open vulnerable ports: {open_ports}')
    else:
        logging.info('No vulnerable ports open')
    
    logging.info('Basic Vulnerability Checker completed')

if __name__ == "__main__":
    run()
